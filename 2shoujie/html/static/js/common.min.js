/*! demo 2015-02-09 */
function is_empty(a){return 0==$.trim(a).length}function login(){var a=$("#user-name").val(),b=$("#pw").val();return 0==a.length||0==b.length?void alert("账号和密码不能为空"):($("#circular-loading").removeClass("hidden"),void $.post("/login",{username:a,password:b},function(a){$("#circular-loading").addClass("hidden"),a=$.parseJSON(a),0==a.code?location.reload():alert(a.msg)}))}function register(){var a=$("#email").val(),b=$("#uname").val(),c=$("#passw").val(),d=$("#cpassw").val();return is_empty(a)||is_empty(b)||is_empty(c)||is_empty(d)?void alert("所有选项必须填写"):($(".load-tip").text("注册中"),$("#circular-loading").removeClass("hidden"),void $.post("/login/register",{email:a,nickname:b,password:c,password_repeat:d},function(a){$("#circular-loading").addClass("hidden"),a=$.parseJSON(a),0==a.code?location.reload():alert(a.msg)}))}function enter_login(a){var b=window.event?a.keyCode:a.which;13==b&&login()}function favorites(){var a=$("#goods_id").val(),b=parseInt($(".ershou-favorite").text());$.post("/goods/favorites",{goods_id:a},function(a){return a=$.parseJSON(a),0!=a.code?void alert(a.msg):(1==a.data.action?(b++,$(".ershou-favorite").css("background-image","url(/resource/image/heart_full.png)")):(b--,$(".ershou-favorite").css("background-image","url(/resource/image/heart.png)")),void $(".ershou-favorite").text(b))})}function cancel_favorites(a){$.post("/goods/cancel_favorites",{goods_id:a},function(b){return b=$.parseJSON(b),0!=b.code?void alert(b.msg):void $("#goods"+a).remove()})}function stu_cert(){var a=$("#i1").attr("param"),b=$("#i1").val(),c=$("#i2").attr("param"),d=$("#i2").val();$.post("/user/stu_cert",{param1:a,param2:c,value1:b,value2:d},function(a){return a=$.parseJSON(a),0!=a.code?void $("#not_match").text(a.msg):($(".std_id_box").hide(),$("#id_succeed").show(),void setTimeout(function(){location.reload()},2e3))})}function off_shelf(a){confirm("下架后商品别人将看不到，是否确认下架")&&$.post("/goods/off_shelf",{goods_id:a},function(a){a=$.parseJSON(a),0!=a.code?alert(a.msg):location.reload()})}function on_shelf(a){$.post("/goods/on_shelf",{goods_id:a},function(a){a=$.parseJSON(a),0!=a.code?alert(a.msg):location.reload()})}function sold(a){confirm("商品卖出后可点此下架商品并获取积分，其他用户将看不到商品，是否确认售出")&&$.post("/goods/sold",{goods_id:a},function(a){a=$.parseJSON(a),0!=a.code?alert(a.msg):location.reload()})}function feedback(){var a=$("#contact").val(),b=$("#feedback").val();return 0==$.trim(b).length?void alert("反馈不能为空哦，亲"):void $.post("/feedback",{contact:a,feedback:b},function(a){a=$.parseJSON(a),0!=a.code?alert(a.msg):($(".fade_back").hide(),$(".thanks_fd").show(),setTimeout(function(){$(".thanks_fd").hide()},2e3))})}function read(a,b){var c=parseInt($(".person_message").text());b&&window.open("/goods/"+b),$.post("/message/read",{message_id:a},function(b){b=$.parseJSON(b),0!=b.code?alert(b.msg):($("#message"+a).remove(),0>=c-1?$(".person_message").remove():$(".person_message").text(c-1))})}!function(){function a(a){return""==a||null==a?0:1}function b(a){return""==a||null==a?0:/^([\.a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/.test(a)}function c(c,d){switch(c){case"text":case"password":return a(d);case"email":return b(d);case"tel":return validTel(d);default:return!1}}var d=function(){function a(){var a;a=void 0!==this.scrollY?this.scrollY:document.documentElement.scrollTop,!c&&a>0?(c=!0,$(d).addClass("scroll"),$(e).addClass("scroll"),$(".nav-icons").addClass("hidden")):c&&0>=a&&(c=!1,$(d).removeClass("scroll"),$(e).removeClass("scroll"),setTimeout(function(){$(".nav-icons").removeClass("hidden")},150))}function b(){$(window).on("scroll",a)}var c=!1,d=$("header"),e=$("nav");return{bind:b}}(),e=function(){function a(){return""==$(d).val()?!1:!0}function b(){$(c).on("submit",function(){return a()})}var c=$(".search-box"),d=$("#keyword");return{bind:b}}(),f=function(){function a(a){this.el=a,this.input=$(this.el).children("input").get(0),this.inputFocus=!1,this.parent=$(this.el).parent().get(0),this.state=0}function b(b){q=$(b).map(function(b,c){return new a(c)}),$(q).each(function(a,b){b.fire()})}function d(a){"l"===a?(j="l",$(k).fadeIn(),b(o),$(k).on("click",function(a){a.target===k.get(0)&&e("l")}),$(n).one("click",function(){e("l"),d("r")})):(j="r",$(l).fadeIn(),b(p),$(l).on("click",function(a){a.target===l.get(0)&&e("r")}),$(m).one("click",function(){e("r"),d("l")}))}function e(a){"l"===a?$(k).fadeOut():$(l).fadeOut(),j="n"}function f(a){"n"===j?d(a):e(a)}function g(){$(h).on("click",".button",function(){f($(this).data("type"))}),$(i).on("click",".comment-login",function(){f($(this).data("type"))})}var h=$(".log-reg"),i=$(".commenting-unlogin"),j="n",k=$(".login-cover"),l=$(".reg-cover"),m=$(".reg-cover a.log"),n=$(".login-cover a.reg"),o=($(".login-cover a.close"),$(".reg-cover a.close"),$(".login-form-container .input-name")),p=$(".reg-form-container .input-name"),q=($(".login-form-container .submit"),$(".reg-form-container .submit"),[]);return a.prototype.binded=[],a.prototype.className="input-name",a.prototype.fire=function(){$(this.input).on("focus",this.handleFocus);var a=this.parent;$.inArray(a,this.binded)>=0||(this.binded.push(a),$(a).on("click","."+this.className,this.handleClick))},a.prototype.handleFocus=function(a){var b=q[$.inArray(a.currentTarget,$(q).map(function(a,b){return b.input}))];b.inputFocus=!0,b.dealInputF()},a.prototype.handleBlur=function(a){var b=a.data.that;b.dealInputB.call(this,b)},a.prototype.handleClick=function(a){var b=q[$.inArray(a.currentTarget,$(q).map(function(a,b){return b.el}))];b.dealInputF()},a.prototype.dealInputF=function(){this.inputFocus||($(this.input).focus(),this.inputFocus=!0),$(this.el).addClass("focus"),$(this.input).one("blur",{that:this},this.handleBlur)},a.prototype.dealInputB=function(a){var b=c(this.type,this.value);a.inputFocus=!1,0===b?($(a.el).removeClass("focus"),a.state=0):b?a.state=1:(alert($(a.el).data("value")+"格式不正确"),a.state=-1)},{bind:g}}();d.bind(),e.bind(),f.bind()}(),$(".login-form-container").find(".submit").on("click",login),$(".reg-form-container").find(".submit").on("click",register);